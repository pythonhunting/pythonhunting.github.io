<!DOCTYPE html>
<html>
    <head>
    <title>Python Hunting | Play Space Invaders</title>
        <link rel=stylesheet type="text/css" href="../style.css">
        <script src="//gemdude46.github.io/libs/Canvas++.js"></script>
        <script src="//gemdude46.github.io/libs/Interact.js"></script>
        <script src="//gemdude46.github.io/libs/+.js"></script>
    </head>
    <body>
        <div class=full>
            <img src="i/pong.png" alt="PONG" id=logo_img>
            <table id=bar>
                <tbody>
                    <tr>
                        <td onclick="location.href='../index.html';">Home</td>
                        <td onclick="location.href='../games.html';">Games</td>
                        <td onclick="location.href='../resources.html';">Images + Sounds</td>
                        <td onclick="location.href='../code.html';">Code</td>
                        <td onclick="location.href='../contact.html';">Contact</td>
                        <td onclick="location.href='../buy.html';">Buy the Book</td>
                    </tr>
                </tbody>
            </table>
            <br><br>
            <center>
                <browser not chrome class="browser_req PM">We recommend using google chrome to play this game.</browser><br><br>
                <canvas width=640 height=650 id=display onclick="m=='s'&&setup()">HTML5 is required to view this content.</canvas>
                <script>
                    var c = CreateCanvasObject('display'), m = 's';
                    var invader_img = createElement('IMG', {src: '/images/badguy.png'}),
                        fighter_img = createElement('IMG', {src: '/images/fightera.png'});
                    
                    var score;
                    var f_x;
                    var missiles;
                    var invaders;
                    
                    onKeyDown('SPACE', function(){
                        if (m != 'g') return;
                        missiles.push([f_x+50, 591]);
                    });
                    
                    function setup(){
                        score = 0;
                        f_x = 270;
                        missiles = [];
                        invaders = [];
                        
                        m = 'g';
                    }
                    
                    setInterval(function(){
                        if (m=='s'){
                            c.fill('black');
                            c.drawCircle([320, 325], 50, '#0b0');
                            c.drawRegPoly([320,325], 3, 40, '#070', Math.PI/2);
                        }
                        if (m=='g'){
                            if (isDown('LEFT') && f_x > 0) f_x -= 3;
                            if (isDown('RIGHT') && f_x < 540) f_x += 3;
                            c.fill('black');
                            for (var missile_i = missiles.length-1; missile_i > -1; missile_i--) {
                                var missile = missiles[missile_i];
                                if (missile[1] < -2) {
                                    missiles.splice(missile_i, 1);
                                    continue;
                                }
                                missile[1] -= 5;
                                c.drawRect([missile[0], missile[1], 1, 8], '#f00');
                            }
                            for (var invader_i = invaders.length-1; invader_i > -1; invader_i--) {
                                var invader = invaders[invader_i];
                                if (invader[1] > 650) {
                                    invader.splice(invader_i, 1);
                                    continue;
                                }
                                invader[0] += invader[2];
                                invader[1] += invader[3];
                                c.blit(invader, invader_img);
                            }
                            c.blit([f_x,591], fighter_img);
                            c.drawText([10,20,'left'], 'Score: ' + score, '15px arial', 'white');
                        }
                    },16);
                    
                    addEventListener("keydown", function(e) {
                        if([32, 37, 38, 39, 40].indexOf(e.keyCode) > -1) {
                            e.preventDefault();
                        } console.log(e.keyCode);
                    }, false);
                </script>
            </center>
            <br><br>
            <div class=PM id=main>Controls:<br>
                LEFT ARROW - move left<br>
                RIGHT ARROW - right right<br>
                SPACE - shoot
            </div>
            <br><br>
        </div>
    </body>
</html>
